# 应用层

- [应用层](#应用层)
  - [HTTP](#http)
    - [方法字段](#方法字段)
    - [状态码](#状态码)
    - [HTTP1.0 HTTP1.1 and HTTP2.0](#http10-http11-and-http20)
    - [HTTPS](#https)
    - [Cookie and Session](#cookie-and-session)
  - [RESTful API](#restful-api)
  - [DNS](#dns)

## HTTP

### 方法字段

客户端发送的**请求报文**第一行为请求行，包含了方法字段。

- **GET**：获取资源。当前网络请求中，绝大部分使用的是 GET 方法。
- **HEAD**：获取报文首部。和GET方法类似，但是不返回报文实体主体部分。一般用于确认URL的有效性以及资源更新的日期时间等。
- **POST**：传输数据。但其请求参数一般放在实体中，而不像GET直接放在URL中。
- **PUT**：上传文件。由于自身不带验证机制，任何人都可以上传文件，因此存在安全性问题，一般不使用该方法。
- **PATCH**：对资源进行部分修改。PUT也可以用于修改资源，但它只能完全替代原始资源，PATCH则允许部分修改。
- **DELETE**：删除文件。与PUT功能相反，并且同样不带验证机制。

其中，GET和POST的异同是最常见的面试问题。它们的差异主要体现在四个方面：

- 作用：GET用于获取资源，而POST用于传输实体主体。
- 参数：尽管GET和POST的请求都能使用额外的参数，但是GET的参数是以查询字符串出现在URL中，而POST的参数存储在实体主体中。
- 安全性：尽管POST参数存储在实体主体中，但它并不具备更高的安全性。因为一些抓包工具（Fiddler）同样可以查看。
- 幂等性：GET、HEAD、PUT和DELETE等方法都具有幂等性，即重复调用的情况下对系统产生的影响是一样的。而POST方法则不具有幂等性。

### 状态码

**2XX 成功**：

- 200 OK
- 204 No Content：请求已经成功处理，但是返回的响应报文不包含实体的主体部分。一般在只需要从客户端往服务器发送信息，而不需要返回数据时使用。
- 206 Partial Content：表示客户端进行了范围请求，响应报文包含由 Content-Range 指定范围的实体内容。

**3XX 重定向**：

- 301 Moved Permanently：永久性重定向。
- 302 Found：临时性重定向。
- 303 See Other：和 302 有着相同的功能，但是 303 明确要求客户端应该采用 GET 方法获取资源。
- 304 Not Modified：如果请求报文首部包含一些条件，例如：If-Match，If-Modified-Since，If-None-Match，If-Range，If-Unmodified-Since，如果不满足条件，则服务器会返回 304 状态码。
- 307 Temporary Redirect：临时重定向，与 302 的含义类似，但是 307 要求浏览器不会把重定向请求的 POST 方法改成 GET 方法。

**4XX 客户端错误**：

- 400 Bad Request：请求报文中存在语法错误。
- 401 Unauthorized：该状态码表示发送的请求需要有认证信息（BASIC 认证、DIGEST 认证）。如果之前已进行过一次请求，则表示用户认证失败。
- 403 Forbidden：请求被拒绝。
- 404 Not Found

**5XX 服务器错误**：

- 500 Internal Server Error：服务器正在执行请求时发生错误。
- 503 Service Unavailable：服务器暂时处于超负载或正在进行停机维护，现在无法处理请求。

### HTTP1.0 HTTP1.1 and HTTP2.0

HTTP 1.0是最早的HTTP版本之一。它最大的问题是浏览器与服务器只能保持短暂的连接，且每个请求/响应都需要建立和关闭一个TCP连接，导致了较大的开销。

为了解决这一问题，HTTP 1.1在1999年发布，对HTTP 1.0进行了大量改进，主要体现在三个方面：

- 持久连接：引入了持久连接，即TCP连接默认不关闭，可以被多个请求复用，不用声明`Connection: keep-alive`。
- 管道机制：即在同一个TCP连接里面，客户端可以同时发送多个请求。
- 分块传输编码：即服务端每产生一块数据，就发送一块，采用”流模式”而取代”缓存模式”。

尽管HTTP 1.1带来了很多改进，但它仍有一个缺陷。即虽然允许在一个TCP连接中复用，但所有请求响应的传输仍然是按序进行的。如果前面的请求处理特别慢，后面的请求就不得不排队等待，导致资源利用率低下。

因此，HTTP 2.0应运而生，作为HTTP协议的最新版本，它包括以下突破性的新特性：

- 二进制分帧：采用二进制格式传输数据，每个数据流被拆分为一系列互不依赖的帧，且可以交错发送，提高效率。
- 完全多路复用：单个连接可以并行发起多个请求响应消息，不再受阻塞影响。
- 头部压缩：通过压缩头部信息，降低开销和提高传输速度。
- 服务器推送：服务器可以主动向客户端推送资源，无需客户端明确请求。

### HTTPS

HTTPS（Hypertext Transfer Protocol Secure）是HTTP协议的安全版本。它通过使用SSL（Secure Sockets Layer）或TLS（Transport Layer Security）协议对HTTP进行加密和身份验证，确保数据在网络传输过程中的保密性和完整性。HTTPS使用加密的SSL/TLS证书来验证服务器和客户端的身份，并使用非对称加密和对称加密来加密通信数据。

### Cookie and Session

Cookie和Session用于存储用户状态和识别用户，使得Web应用能够提供个性化服务和持久化登录。其中，Cookie是服务器发送到浏览器并保存在用户电脑中的一小段数据。它与特定的Web文档关联在一起，保存了该用户访问这个Web文档时的状态信息，以便其再次访问使可以恢复至前一次状态。它可通过在HTTP报文的首部中添加Cookie字段进行传递。

至于Session，它则是在服务器端存储用户状态的一种机制。通过在服务器端创建一个唯一的会话标识（Session ID），将用户的状态信息存储在服务器上。有些Session的实现依赖于Cookie，它使用Cookie在浏览器和服务端之间传递Session ID。

根据Cookie有效时长，可将其分为会话级别Cookie和持久级别Cookie。前者在浏览器关闭之后Cookie就会失效，而后者则保存在硬盘的，即使重启浏览器也不会失效。一般来说，Cookie有以下特点：

- 长度有限制
- 数量有限制
- 有时效性
- 通常由key/value组成

## RESTful API

RESTful API（Representational State Transfer）是一种设计和构建Web服务的架构风格。它基于HTTP协议，通过使用不同的HTTP方法（如GET、POST、PUT、DELETE等）和URI（统一资源标识符）来表示和操作资源。RESTful API的设计目标是简单、可扩展、易于理解和使用。

## DNS

- 客户端发起域名解析请求：当用户在浏览器中输入一个域名时，客户端会向本地DNS解析器（如操作系统或路由器）发起域名解析请求。
- 本地DNS解析器查询本地缓存：本地DNS解析器首先会查询本地的DNS缓存，看是否之前已经解析过该域名。
本地DNS解析器查询根域名服务器：如果本地缓存中没有找到对应的解析结果，本地DNS解析器会向根域名服务器发送查询请求。根域名服务器负责管理顶级域名（如.com、.org、.net等）的DNS信息。
- 根域名服务器返回顶级域名服务器信息：根域名服务器收到查询请求后，会返回对应顶级域名服务器的IP地址给本地DNS解析器。顶级域名服务器负责管理该域名的DNS信息。
- 本地DNS解析器查询顶级域名服务器：本地DNS解析器收到顶级域名服务器的IP地址后，会向顶级域名服务器发送查询请求。
- 顶级域名服务器返回域名服务器信息：顶级域名服务器收到查询请求后，会返回该域名的域名服务器的IP地址给本地DNS解析器。
- 本地DNS解析器查询域名服务器：本地DNS解析器收到域名服务器的IP地址后，会向域名服务器发送查询请求。
- 域名服务器返回IP地址：域名服务器收到查询请求后，会返回该域名对应的IP地址给本地DNS解析器。
- 本地DNS解析器将解析结果返回给客户端：本地DNS解析器收到IP地址后，将解析结果返回给客户端。
-客户端发起网络请求：客户端收到IP地址后，会使用该IP地址发送网络请求到对应的服务器，完成域名解析过程。
