# 数字图像处理基础

- [数字图像处理基础](#数字图像处理基础)
  - [数字图像基础](#数字图像基础)
    - [数字图像和其处理](#数字图像和其处理)
    - [图像感知和获取](#图像感知和获取)
    - [图像取样和量化](#图像取样和量化)
    - [图像内插](#图像内插)
    - [像素间的基本关系](#像素间的基本关系)
  - [灰度变换与空间滤波](#灰度变换与空间滤波)
    - [基本灰度变换](#基本灰度变换)
    - [直方图处理](#直方图处理)
    - [滤波基础——卷积](#滤波基础卷积)
    - [平滑空间滤波](#平滑空间滤波)
    - [锐化空间滤波](#锐化空间滤波)
  - [频域滤波](#频域滤波)
  - [图像复原](#图像复原)
    - [噪声模型](#噪声模型)
    - [噪声消除](#噪声消除)
  - [色彩图像处理](#色彩图像处理)

数字图像处理是计算机视觉的基础，它主要研究图像的数字化表示、操作和分析。传统计算机视觉研究（不涉及深度学习相关知识）都依赖数字图像处理理论，且很多算法的基础和预处理步骤也都来源于此，因此了解数字图像处理是很有必要的。

对于数字图像处理来说，它的几乎所有操作都可以归类为某种算子。而算子则是指从一个向量空间到另一个向量空间的映射。从运算类型的角度，可分为：

- 点算子: 只与当前像素有关，如直方图均衡化。
- 区域算子: 与邻域像素有关，如平滑/锐化滤波。
- 全局算子: 与整幅图像有关，如傅里叶变换。

从算子性质的角度，可分为:

- 线性算子: 如均值滤波。
- 非线性算子: 如中值滤波

从运算域的角度，可分为：

- 空间域算子: 如卷积滤波。
- 频率域算子: 如理想低通滤波。

## 数字图像基础

### 数字图像和其处理

数字图像是指由被称作像素的小块区域组成的二维矩阵。将物理图像行列划分后，每个小块区域称为像素。每个像素包括两个属性：位置和亮度（也称为强度、灰度、幅值等）。此外，图片又可按其像素取值分为

- 二值图像：像素值只有两种状态，通常用0和1表示黑和白，常用于文字识别和简单的对象分割。
- 灰度图像：像素值为连续的灰度级，从0（黑色）到255（白色），用于表示黑白或灰度图像。
- 彩色图像：像素值由红、绿、蓝三个分量组成，每个分量的值范围也是0到255。除了这种最常见的RGB模型之外，还有多种色彩模型用于描述颜色，比如：HSV、YUYV等。
- 索引图像：像素值为调色板下标。一般来说，一幅索引图包含一个数据矩阵data和一个调色板矩阵map，数据矩阵可以是uint8，uint16或双精度类型的，而调色板矩阵则总是一个m×3的双精度矩阵。

数字图像处理包括两部分处理：既包括输入和输出均是图像的处理，也包括从图像中提取特征及识别特定物体的处理。

### 图像感知和获取

图像传感器（如CCD或CMOS）捕捉光信号并将其转化为电信号，然后通过模数转换器（ADC）将电信号转换为数字信号，形成数字图像。

### 图像取样和量化

- 采样：用有限的样本数目去近似无限的现实物理信号；或简而言之，有限近似无限。
- 量化：用离散计算机表示去近似连续的现实物理信号；或简而言之，离散近似连续。

通过取样和量化，可以得到一个大小为M*N、灰度等级为L的图像。其中，对于M和N，除了必须取正整数外没有其他限制。而出于存储和量化硬件的考虑，L一般取整数次幂。

### 图像内插

图像内插是指用已知数据来估计位置未知的数值。常见的内插方法包括：

- 双线性内插法：用4个最近邻去估计给定位置的灰度
- 双三次内插法：用16个最近邻去估计给定位置的灰度

### 像素间的基本关系

**邻接性**：

- 4邻接：上下左右
- 8邻接：上下左右+对角邻接

**距离**：

- 欧式距离：两像素间直线距离的平方根。
- 曼哈顿距离：两像素间沿水平和垂直方向距离之和。
- 棋盘距离：两像素间沿任意方向的最大距离。

## 灰度变换与空间滤波

空域指图像平面本身，这类图像处理方法直接以图像中的像素操作为基础。和空域相对的是频域，频域相关的处理方法首先需要将一副图像使用傅里叶变换到频域，处理后再用傅里叶反变换把结果返回空间域。

### 基本灰度变换

**图像反转**：

该变换将图像的灰度值取反，即0变255，255变0。其公式如下：`s=L-1-r`，其中L是灰度等级、r是原灰度、s是目标灰度。

**对数变换**：

该变换通用形式如下：`s=clog(1+r)`。它可以将范围较窄的低灰度值映射到一个较宽的范围；而可以将一个较宽的高灰度值映射到一个较窄的范围。换句话说，它用于增强图像的低灰度部分，压缩高灰度部分。

**幂律（伽马）变换**：

伽马变换形式如下：`s=cr^gama`。为图像进行伽马编码的目的是用来对人类视觉的特性进行补偿，从而根据人类对光线或者黑白的感知，最大化地利用表示黑白的数据位或带宽。

### 直方图处理

直方图表示图像中每个灰度级的像素数量，其横坐标是灰度级，而纵坐标则表示该灰度级出现的频率。它一般用于图像的对比度增强、均衡化等。常见的直方图处理手段包括：直方图均衡化和直方图规定化。

- **直方图均衡化**是指运用某种数学变换使原始图像的直方图变换为在整个灰度范围内均匀分布，从而改善原图像看起来处于一个色调的情况。
- **直方图规定化**是指有选择地增强某个灰度范围内的对比度或使图像灰度值满足某种特定的分布。

此外，直方图还可以用于解决以下问题，包括：

- **图像快速检测**：可以利用灰度直方图来判断一幅图像是否合理的利用了全部被允许的灰度级范围，从而及早发现数字化中出现的问题。
- **分割前景和背景**：以直方图两峰之间的谷地T为阈值来确定边界，可把图像分为前景背景两部分。
- **计算图像面积**：当图像背景灰度大体均匀一致，且背景与物体对比度很强时，可以使用直方图快速计算图像背景。

### 滤波基础——卷积

卷积是图像处理中的核心操作，它通过将滤波器（也称为卷积核或模板）与图像的每个像素进行滑动并计算加权和来处理图像。卷积可以表示为：$g(x, y)=f(x, y)*h(x, y)=\Sigma_{s=-a}^a\Sigma_{t=-b}^bf(s, t)h(x-s, y-t)$

![卷积实例](https://img-blog.csdnimg.cn/20181104014111256.gif)

### 平滑空间滤波

平滑滤波器一般用于模糊处理和降低噪声。它可按计算方法分为平滑线性滤波器和统计排序（非线性）滤波器。下面逐一介绍一下常见的滤波器：

- **均值滤波器**是最简单的线性滤波器，它通过计算像素邻域内的像素值平均值来替换中心像素的值。这有助于消除噪声，但可能导致边缘模糊。
- **加权线性滤波器**使用不同权重的邻域像素值进行滤波，权重通常随着距离中心像素的增加而减小。
- **高斯滤波器**是加权线性滤波器的一个例子，其权重由高斯函数决定，对中心像素赋予最大权重，对远离中心的像素赋予较小权重，这在平滑图像的同时能较好地保持边缘。
- **中值滤波器**是一种非线性滤波器，它将中心像素替换为其邻域像素排序后的中值。这种方法对椒盐噪声有很好的去除效果，同时能较好地保护边缘。

### 锐化空间滤波

锐化处理的目的是增强图像的边缘和细节，通常通过空间微分来实现。站在数学的角度而言，数字图像的边缘往往具有比较大的灰度落差，即斜坡，而微分正是用于描述函数的局部变化。因此，可以使用空间微分去捕获这些斜坡。

**一阶导数和二阶导数**：

对于离散函数而言，其微分的基本定义是差值。因此，可以得到一阶微分表达式`f(x+1)-f(x)`和二阶微分表达式`f(x+1)+f(x-1)-2*f(x)`。当计算图像边缘的导数时，一阶导数通常产生较粗的边缘，即边缘处导数一直非零；而二阶导数则产生两个有间距的双边缘（由零分开，单像素宽）。关于二者区别，具体如下图所示。

![一阶导数和二阶导数的区别](../img/computer_vision_differential.png)

**拉普拉斯算子**：拉普拉斯算子是一个二阶微分算子，用于检测图像的边缘。它通过计算像素的梯度来找出图像的突变点，即边缘。它通常包括标准和对角线两种形式，具体如下：

- 标准形式：[[0, 1, 0], [1, -4, 1], [0, 1, 0]]
- 对角线形式：[[1, 1, 1], [1, -8, 1], [1, 1, 1]]

**非锐化遮蔽**：

非锐化遮蔽是一种图像增强技术，它通过将原始图像与经过平滑处理的图像相减，然后将结果加回原始图像来增强边缘。这种方法可以看作是锐化滤波的一种形式，它通过对比度增强来突出图像的边缘和细节。

## 频域滤波

## 图像复原

### 噪声模型

### 噪声消除

## 色彩图像处理
